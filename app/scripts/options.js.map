{"version":3,"sources":["../scripts.babel/options.js"],"names":[],"mappings":"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","file":"options.js","sourcesContent":["'use strict';\n\nlet $ = function(q) {\n  let result = document.querySelectorAll(q);\n  return result.length === 1 ? result[0] : result;\n};\nlet $new = tag => document.createElement(tag);\nlet bgJS = chrome.extension.getBackgroundPage();\nlet listEl = $('#folder-list');\nlet folderCountEl = $('#status-folder-count');\nlet bookmarkCountEl = $('#status-bookmark-count');\nlet timerRadioElList = [...$('input[name=\"timer\"]')];\nlet frag = document.createDocumentFragment();\n\n\n// Dom Generation / Manipulation\n\nfunction updateFolderCounts(response) {\n  console.log(response);\n  folderCountEl.textContent = bgJS.folderIDs.size || 'all';\n  bookmarkCountEl.textContent = bgJS.bookmarks.length;\n}\n\nfunction genFolderList( list = bgJS.folders, containerEl = frag ) {\n\n  list.forEach( folder => {\n\n    let li = $new('li');\n    let label = $new('label');\n    let check = $new('input');\n    let span = $new('span');\n\n    check.id = `folder-${folder.id}`;\n    check.value = folder.id;\n    check.setAttribute('type', 'checkbox');\n    check.checked = bgJS.folderIDs.has(folder.id);\n\n    span.textContent = folder.title;\n    label.appendChild(check);\n    label.appendChild(span);\n    li.appendChild(label);\n\n//  recurse and create sub folders\n    if (folder.children) {\n\n      let ul = $new('ul');\n\n      genFolderList( folder.children, ul );\n      li.appendChild(ul);\n    }\n\n    containerEl.appendChild(li);\n  });\n}\n\nfunction getDescendantInputs(parentEl) {\n\n  let li = parentEl.parentNode.parentNode;\n  let inputs = [...li.querySelectorAll('input')];\n\n  return inputs;\n}\n\nfunction toggleCheckboxUI( inputs, isChecked ) {\n  for ( let i in inputs ) {\n    inputs[i].checked = isChecked;\n  }\n}\n\nfunction resetCheckboxUI() {\n  toggleCheckboxUI( [...listEl.querySelectorAll('input')], false );\n}\n\nfunction selectCurrentTimerRadio() {\n  timerRadioElList.forEach( radio => {\n\n    if ( Boolean(+radio.value) === bgJS.hasTimer ) {\n      radio.checked = true;\n    }\n  });\n}\n\n// Events\n\nfunction toggleFolder(inputs) {\n\n  let folderIDList = {};\n\n  inputs.forEach(input => {\n    folderIDList[input.value] = input.checked;\n  });\n\n  chrome.runtime.sendMessage({\n    action: 'toggleFolder',\n    folders: folderIDList,\n    responseCallback: updateFolderCounts\n  }, updateFolderCounts );\n\n}\n\nfunction resetFolders() {\n  bgJS.folderIDs.clear();\n  bgJS.refreshBookmarks();\n  resetCheckboxUI();\n  updateFolderCounts();\n}\n\n// TODO: turn this into a universal event bubbling listener and use for the timer radios\nlistEl.addEventListener('click', event => {\n\n  let possibleTargets = listEl.querySelectorAll('input');\n\n  for ( let index in possibleTargets )\n  {\n    let possibleTarget = possibleTargets[index];\n    let el = event.target;\n\n    while (el && el !== listEl)\n    {\n      if (el === possibleTarget)\n      {\n        let isParentChecked = el.checked;\n        let inputs = getDescendantInputs(el);\n\n        toggleCheckboxUI(inputs, isParentChecked);\n        toggleFolder(inputs);\n      }\n\n      el = el.parentNode;\n    }\n  }\n});\n\ndocument.querySelector('#action-folders-clear').addEventListener('click', resetFolders);\ntimerRadioElList.forEach( radio => {\n  radio.addEventListener('click', event => {\n    bgJS.hasTimer = Boolean( +event.target.value );\n  });\n});\n\n\n/*\n    Initialise\n    ==========\n*/\n\ngenFolderList();\nlistEl.appendChild(frag);\nupdateFolderCounts();\nselectCurrentTimerRadio();\n"]}